<html>
	<head>
	<!--
	 * Author:		Gianluca Guarini
	 * Contact: 	gianluca.guarini@gmail.com
	 * Website:		http://www.gianlucaguarini.com/
	 * Twitter:		@gianlucaguarini
	-->
		<title>Push notification server</title>
		<style>
			body{
				font-family: verdana;
				font-size: 12px,
			}

			.time{
				font-family: verdana;
				font-size: 9px;
				background-color: #00DCFE;
				padding: 2px;
				padding-left: 5px;
				border-radius:5px;
				border-top-left-radius:0px;
				border-top-right-radius:0px;
				border-top:0px;
				width: 400px;
				margin-left: 6px;
				margin-bottom: 5px;
			}

			.container {
				border:2px solid #00ddff;
				background-color: #d3f9ff;
				padding: 10px;
				border-radius:5px;
				width: 40%;

			}

			.header{
				font-family: verdana;
				font-size: 14px;
				background-color: #ededed;
				padding: 10px;
				padding-left: 10px;
				border-radius:10px;
				border-top-left-radius:0px;
				border-top-right-radius:0px;
				border-top:0px;
				width: 98%;
			}
            
            #mensaje {
                width: 564px;
                height: 50px;
                border: 0px;
                border:2px solid #dddddd;
				padding: 10px;
				border-radius:5px;
				font-size: 14px;
                margin-bottom: 5px;
            }

		</style>
	</head>
	<body topmargin="0">
		<div class="header">Testing - socket.io / express</div>
		<h4>&nbsp;&nbsp;Notificaciones recibidas</h4>
            <input type="text"  id="Mensaje" placeholder="Mensaje"/>
        
        <div id="itemsContainer">
		 </div>
	<script src="socket.io/socket.io.js"></script>
	<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
	<script>
        
        function pastelColors(){
    var r = (Math.round(Math.random()* 127) + 127).toString(16);
    var g = (Math.round(Math.random()* 127) + 127).toString(16);
    var b = (Math.round(Math.random()* 127) + 127).toString(16);
    return '#' + r + g + b;
}
        
     $(document).ready(function(){
         $.color = pastelColors();
     });
        
	 var socket = io.connect('http://10.0.33.66:8899');
	  socket.on('news', function (data) {
	    var obj = '<div class="container" style="background-color:'+data.color+'">'+data.data+'</div> <div class="time"><time>'+new Date()+'</time></div>';
	    $('#itemsContainer').prepend(obj);
	    $(".header").fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100);
	    socket.emit('my other event', { my: 'data' });
	  });
	
    $('#Mensaje').keyup(function(e){
    if(e.keyCode == 13)
    {
        $(this).trigger("enterKey");
    }
});
    
    $('#Mensaje').bind("enterKey",function(e){
        if($('#Mensaje').val()!=""){
            enviar();
        }
        
    });
    
        
        function enviar () {
             $.ajax({
                type: 'POST',
                url: 'http://10.0.33.66:8899/notificaciones',
                data: '{"data":'+'"'+$('#Mensaje').val()+'","color":"'+$.color+'"}',
                contentType: "application/json",
                success: function(data) { $('#Mensaje').val(''); },
                dataType: 'json'
            });
        }
        
        // 
    
	</script>
	</body>
</html>
